#!/usr/bin/python2.7

#############################################################################################
#Change the filtered maf file generated by R and output as a snp cll type file
#############################################################################################

import sys
import os
import csv

#set up script
os.chdir('/Users/d.brown6/Documents/eQTL/Matrix_eQTL_R/')
inFile = sys.argv[1]
outFile = sys.argv[2]
data = []

#read in the files
f = open(inFile, 'U')
files = csv.reader(f, delimiter='\t')
for row in files:
    data.append(row)
    
#get the header row then remove it from data
dataHeader = data[0][:]
data = data[1:]

#create a list of patient IDs
def makeListFromColumn(table, columnNumber):
    'Do a function thing'    
    extractedList = []
    for row in table:
        extractedList.append(row[columnNumber])
    extractedListDedup = sorted(set(extractedList))
    return extractedListDedup

tumourSampleBarcode = makeListFromColumn(data, 2)
geneExtractedList = makeListFromColumn(data, 0)

#-------------------------------Trying the dictionary way--------------------------------- 
matrix = dict.fromkeys(geneExtractedList, tumourSampleBarcode)

#iterate over the genes in the dictionary and then the maf file
for gene in matrix.keys():
    #Apparently for loops use an internal index and f you modify the list you are iterating over so can screw thngs up. Solution is to iterate oer a copy of the list
    for row in data[:]:
    #if there is a match between the key and the maf file    
        if gene == row[0]:
        #iterate through the patient IDs of the match key-value  
            for patientID in matrix[gene]:
            #if there is match between the maf patientID and the dict value, set to 1
                if patientID == row[2]:
                    matrix[gene][matrix[gene].index(patientID)] = True
                else:
                    break                          
            
            
#should be 3 values for TP53 if this works
print matrix
    